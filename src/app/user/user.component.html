<div class="container mt-5">
  <div class="card shadow p-4">
    <h2 class="text-center">Hallo {{ userData?.userName }}, willkommen!</h2>
    <p class="text-center">Hier kannst du deine Daten verwalten.</p>

<!-- ✅ Erfolgs- & Fehlermeldungen anzeigen -->
<div *ngIf="loginMessage" class="alert alert-success text-center">
  {{ loginMessage }}
</div>
<div *ngIf="successMessage" class="alert alert-success text-center">
  {{ successMessage }}
</div>
<div *ngIf="errorMessage" class="alert alert-danger text-center">
  {{ errorMessage }}
</div>

<!-- ✅ Direkt die Benutzerdaten anzeigen -->
<div class="card shadow p-4 mt-4">
  <h4 class="text-center mb-4">Deine persönlichen Daten</h4>
  <div class="row">
    <div class="col-md-6">
      <p><strong>E-Mail:</strong> {{ userData?.email }}</p>
      <p><strong>Benutzername:</strong> {{ userData?.userName }}</p>
      <p><strong>Vorname:</strong> {{ userData?.firstName || 'Nicht bekannt' }}</p>
      <p><strong>Nachname:</strong> {{ userData?.lastName || 'Nicht bekannt' }}</p>
      <p><strong>Titel:</strong> {{ userData?.title || 'Kein Titel' }}</p>
      <p><strong>Geschlecht:</strong> {{ getGenderTranslation(userData?.gender) }}</p>
      <p><strong>Erstellt am:</strong> {{ userData?.createdAt | date:'dd.MM.yyyy' }}</p>

      
    </div>
    <div class="col-md-6">
      <p><strong>Adresse:</strong> {{ userData?.street }}, {{ userData?.zip }} {{ userData?.city }}, {{ userData?.country }}</p>
      <p><strong>Telefon Privat:</strong> {{ userData?.phonePrivate || 'Nicht angegeben' }}</p>
      <p><strong>Telefon Mobil:</strong> {{ userData?.phoneMobile || 'Nicht angegeben' }}</p>
      <p><strong>Telefon Arbeit:</strong> {{ userData?.phoneWork || 'Nicht angegeben' }}</p>
      <p><strong>Geburtsdatum:</strong> {{ userData?.birthDate ? (userData?.birthDate | date:'dd.MM.yyyy') : 'Nicht bekannt' }}</p>
      <p><strong>Alter:</strong> {{ getUserAge(userData?.birthDate) }}</p>
    </div>
  </div>
</div>




    <!-- ✅ Buttons -->
<div class="text-center mt-3">
  <button class="btn btn-primary" (click)="openModal()">Bearbeiten</button>
</div>

  </div>
</div>

<!-- ✅ Modal für Bearbeitung der Daten -->
<div class="modal fade" id="userModal" tabindex="-1" aria-labelledby="userModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="userModalLabel">Meine Daten bearbeiten</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form #userForm="ngForm" (ngSubmit)="onSaveChanges()">
          
          <!-- ✅ E-Mail und Benutzername -->
          <div class="row">
            <div class="col-md-6">
              <label for="email" class="form-label">E-Mail</label>
              <input type="email" class="form-control" id="email" [(ngModel)]="updatedUserData.email" name="email" disabled>
            </div>
            <div class="col-md-6">
              <label for="username" class="form-label">Benutzername</label>
              <input type="text" class="form-control" id="username" [(ngModel)]="updatedUserData.userName" name="userName">
            </div>
          </div>

          <!-- ✅ Vorname & Nachname -->
      <div class="row mt-3">
        <div class="col-md-6">
          <label for="firstName" class="form-label">Vorname</label>
          <input type="text" class="form-control" id="firstName" [(ngModel)]="updatedUserData.firstName" name="firstName">
        </div>
        <div class="col-md-6">
          <label for="lastName" class="form-label">Nachname</label>
          <input type="text" class="form-control" id="lastName" [(ngModel)]="updatedUserData.lastName" name="lastName">
        </div>
      </div>

          <!-- ✅ Geschlecht & Titel -->
          <div class="row mt-3">
            <div class="col-md-6">
              <label for="title" class="form-label">Titel</label>
              <select class="form-control" id="title" [(ngModel)]="updatedUserData.title" name="title">
                <option value="">Kein Titel</option>
                <option value="Dr.">Dr.</option>
                <option value="Prof.">Prof.</option>
                <option value="Prof. Dr.">Prof. Dr.</option>
                <option value="Dipl.-Ing.">Dipl.-Ing.</option>
                <option value="M.Sc.">M.Sc.</option>
                <option value="M.A.">M.A.</option>
                <option value="B.Sc.">B.Sc.</option>
                <option value="B.A.">B.A.</option>
                <option value="Mag.">Mag.</option>
                <option value="MBA">MBA</option>
              </select>
            </div>
            <div class="col-md-6">
              <label for="gender" class="form-label">Geschlecht</label>
              <select class="form-control" id="gender" [(ngModel)]="updatedUserData.gender" name="gender">
                <option value="male">Männlich</option>
                <option value="female">Weiblich</option>
                <option value="other">Divers</option>
              </select>
            </div>
          </div>

          <!-- ✅ Adresse -->
          <div class="row mt-3">
            <div class="col-md-6">
              <label for="street" class="form-label">Straße</label>
              <input type="text" class="form-control" id="street" [(ngModel)]="updatedUserData.street" name="street">
            </div>
            <div class="col-md-6">
              <label for="zip" class="form-label">PLZ</label>
              <input type="text" class="form-control" id="zip" [(ngModel)]="updatedUserData.zip" name="zip">
            </div>
          </div>

          <div class="row mt-3">
            <div class="col-md-6">
              <label for="city" class="form-label">Stadt</label>
              <input type="text" class="form-control" id="city" [(ngModel)]="updatedUserData.city" name="city">
            </div>
            <div class="col-md-6">
              <label for="country" class="form-label">Land</label>
              <input type="text" class="form-control" id="country" [(ngModel)]="updatedUserData.country" name="country">
            </div>
          </div>

          <!-- ✅ Telefonnummern -->
          <div class="row mt-3">
            <div class="col-md-6">
              <label for="phoneMobile" class="form-label">Mobilnummer</label>
              <input type="text" class="form-control" id="phoneMobile" [(ngModel)]="updatedUserData.phoneMobile" name="phoneMobile">
            </div>
            <div class="col-md-6">
              <label for="phonePrivate" class="form-label">Telefon (Privat)</label>
              <input type="text" class="form-control" id="phonePrivate" [(ngModel)]="updatedUserData.phonePrivate" name="phonePrivate">
            </div>
          </div>
          <div class="row mt-3">
            <div class="col-md-6">
              <label class="form-label">Telefon Arbeit</label>
              <input type="text" class="form-control" [(ngModel)]="updatedUserData.phoneWork" name="phoneWork">
            </div>
            
            <!-- ✅ Geburtsdatum -->
            <div class="col-md-6">
              <label for="birthDate" class="form-label">Geburtsdatum</label>
              <input type="date" class="form-control" id="birthDate" [(ngModel)]="updatedUserData.birthDate" name="birthDate">
            </div>
          </div>
          

          <!-- ✅ Passwort ändern -->
          <div class="row mt-3">
            <div class="col-md-6">
              <label for="password" class="form-label">Neues Passwort</label>
              <input type="password" class="form-control" id="password" [(ngModel)]="updatedUserData.password" name="password">
            </div>
            <div class="col-md-6">
              <label for="confirmPassword" class="form-label">Neues Passwort wiederholen</label>
              <input type="password" class="form-control" id="confirmPassword" [(ngModel)]="confirmPassword" name="confirmPassword">
            </div>
          </div>

          <!-- ❌ Fehlermeldung anzeigen -->
          <p *ngIf="passwordMismatch" class="text-danger">Die Passwörter stimmen nicht überein!</p>

          <!-- ✅ Buttons -->
          <div class="text-center mt-4">
            <button type="submit" class="btn btn-success">Speichern</button>
            <button type="button" class="btn btn-secondary ms-2" data-bs-dismiss="modal">Abbrechen</button>
          </div>

        </form>
      </div>
    </div>
  </div>
</div>

